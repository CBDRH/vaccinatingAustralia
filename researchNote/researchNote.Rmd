---
title: 'Vaccinating Australia: How long will it take?'
authors:
  - name: Mark Hanly
    department: Centre for Big Data Research in Health
    affiliation: UNSW Sydney
    location: Sydney 2052
    email: m.hanly@unsw.edu.au
  - name: Tim Churches
    department: Ingham Institute for Applied Medical Research
    affiliation: South Western Sydney Clinical School, Faculty of Medicine, UNSW Sydney
    location: Liverpool
    email: timothy.churches@unsw.edu.au
  - name: Oisín Fitzgerald
    department: Centre for Big Data Research in Health
    affiliation: UNSW Sydney
    location: Sydney 2052
    email: o.fitzgerald@unsw.edu.au
  - name: Louisa Jorm
    department: Centre for Big Data Research in Health
    affiliation: UNSW Sydney
    location: Sydney 2052
    email: l.jorm@unsw.edu.au
abstract: |
  Add abstract here.
keywords:
  - COVID19
  - vaccination
bibliography: references.bib
biblio-style: unsrt
csl: jama.csl
output: 
  rticles::arxiv_article:
    keep_tex: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, error = FALSE, message = FALSE)

# libraries
library(dplyr)
library(kableExtra)

# Source functions
source('../R/sumScenario.R')
source('../R/plotScenario.R')

# Load scenario data
load('../Outputs/sc1.rda')
load('../Outputs/sc2.rda')
load('../Outputs/sc3.rda')
load('../Outputs/sc4.rda')
load('../Outputs/sc5.rda')
load('../Outputs/sc6.rda')
load('../Outputs/sc7.rda')
load('../Outputs/sc8.rda')
load('../Outputs/sc9.rda')
```

\newpage

# Introduction

The development and regulatory approval of multiple safe and efficacious COVID-19 vaccines in less than a year is a truly remarkable achievement. The logistical task of administering the vaccine rapidly and fairly to billions of people around the world will be no less of a challenge. National vaccination programs have commenced in many countries including Israel, the United States and the United Kingdom. The Australian government has entered into four agreements for the supply of COVID-19 vaccines (Table \ref{tab:agreements}), with a view to starting distribution in mid-February. and an ambitious target to vaccinate the adult community by the end of October. This gives around 37 weeks to administer two doses each to some 20 million adult Australians. 

```{r}

t0 <- data.frame(
  name = c('Pfizer/BioNTech', 'University of Oxford AstraZeneca', 'Novavax', 'COVAX Facility'),
  type = c('mRNA vaccine', 'Viral vector vaccine', 'Protein vaccine', 'Assorted'),
  doses = c('10', '54', '51', '25'), 
  schedule = c('2 doses 21 days apart', '2 doses 28 days apart', '2 doses 21 days apart', 'Assorted'),
  status = c('Provisionally approved by the TGA',
             'Phase 3 clinical trials',
             'Phase 3 clinical trials', '9 candidate vaccines in various clinical trial stages')
)
  
kbl(t0,
      format = 'latex',
      booktabs = TRUE,
      linesep = '',
      label = 'agreements', 
      align = c('llcll'),
      col.names = c("Name", "Type", "Doses (millions)", 'Schedule', 'Status'),
      caption = "Australia’s vaccine agreements") %>%
      kable_styling(latex_options = c("hover", "striped", "HOLD_position"),
                    position = "center") %>% 
      column_spec(1, width = '3cm') %>%
      column_spec(2, width = '3cm') %>%
      column_spec(3, width = '1cm') %>%
      column_spec(4, width = '2cm') %>%
      column_spec(5, width = '5cm') %>%
      add_footnote('Adapted from https://www.health.gov.au/initiatives-and-programs/covid-19-vaccines/about-covid-19-vaccines/australias-vaccine-agreements', notation = 'none', threeparttable = TRUE)

```

The national rollout strategy divides the population into 16 groups, organised into five phases (Table \ref{tab:phases}). Hospital hubs with access cold chain storage facilities will administer the Pfizer/BioNTech vaccine to the highest priority groups scheduled in Phase 1a, which includes border workers, frontline healthcare staff, and aged care staff and residents. Pending approval, the Astra Zeneca vaccine would be administered to the bulk of the population thorugh a network of GPs and pharmacies, The prime minister has quoted a target of 80,000 vaccinations per day [@pm2021], however a back of the envelope calculation would suggest that at this rate it would take some 500 days to vaccinate 20 million adult Australians twice, placing the finish line somewhere around the middle of 2022. To reach the October target would take closer to 160,000 daily vaccinations. 

An added complication is that the Pfizer/BioNTech and AstraZeneca vaccines both require two doses---a primer and a booster---which need to be delivered within a specified time frame after the initial shot. This complicates rollout as the daily resources of both vaccine units and healthcare staff must be divided between those waiting for their first jab and those returning for their booster.    

```{r}
t1 <- data.frame(
        phase = c('1a', '1a', '1a', '1a', '1b', '1b', '1b', '1b', '1b', '1b', '2a', '2a', '2a', '2a', '2b', '3'),
        desc = c('Quarantine & border workers',
                    'Frontline health care workers',
                    'Aged care and disability care staff',
                    'Aged care and disability care residents',
                    'Elderly adults aged 80 years and over',
                    'Elderly adults aged 70-79 years',
                    'Other health care workers',
                    'Aboriginal and Torres Strait Islander people aged 55 years and over',
                    'Younger adults with an underlying medical condition',
                    'Critical and high risk workers',
                    'Adults aged 60-69',
                    'Adults aged 50-59',
                    'Aboriginal and Torres Strait Islander people aged 18-54',
                    'Other critical and high risk workers',
                    'Balance of adult population',
                    '<18 if recommended'),
                size = format(c(70000, 100000, 318000, 190000, 1045000, 1858000, 953000, 87000, 2000000, 196000, 2650000, 3080000, 387000, 453000, 6643000, 5670000), big.mark = ','))

kbl(t1,
      format = 'latex',
      booktabs = TRUE,
      linesep = '',
      label = 'phases', 
      align = c('llr'),
      col.names = c("Phase", "Description", "Size"),
      caption = "Australia’s COVID-19 vaccine national roll-out strategy") %>%
      kable_styling(latex_options = c("hover", "striped", "HOLD_position"),
                    full_width = FALSE,
                    position = "center") %>% 
      column_spec(1, bold = T, width = '1cm') %>%
      column_spec(2, width = '11cm') %>% 
      column_spec(3, width = '2cm') %>% 
      add_footnote('Adapted from https://www.health.gov.au/sites/default/files/documents/2021/01/australia-s-covid-19-vaccine-national-roll-out-strategy.pdf', notation = 'none', threeparttable = TRUE)
```

Another unknown is the question of vaccine hesitancy, which refers to the delay in acceptance or refusal to take a vaccine despite one being available. [@macdonald2015vaccine] Clearly, high levels of vaccine hesitancy would have the potential to undermine efforts to vaccinate the population. An online survey of over 3,000 Australian adults undertaken in August 2020 asked respondents if they would take a safe and effective vaccine for COVID-19, if one was developed. The population-weighted responses were 5.5% definitely not, 7.2 probably not, 28.7% probably and 58.5% definitely. [@edwards2020covid] 

The aim of this analysis is to estimate how long it will take to distribute the two-dose COVID-19 vaccine schedule to the Australian population. We consider a variety of scenarios based on the daily vaccine capacity, the timeframe between the first and second dose and the scale of vaccine hesitancy in the population. We conclude by comparing daily vaccination rates from countries where vaccination programs are already underway. 

# Methods

## Population and priority groups
Our analysis was based on the 16 priority groups and five phases proposed by the Australian government (see Table \ref{tab:phases}). Th implied population size is 25.7 million people, including 5.67 million children and adolescents under the age of 18. We assumed that equal priority was given to all groups within the same phase.

## Vaccine roll out projections
Roll out projections were based on four parameters: 

1. The daily vaccination capacity. 
2. The minimum number of days between the first dose and the second dose.
3. The maximum number of days between the first dose and the second dose.
4. Vaccine hesitancy

## Projection scenarios
Projection scenarios were based on a $2^k$ factorial design defined by three factors with two levels each. The scenarios are summarised in Table \ref{tab:scenarios} and the three factors and levels are detailed below: 

* Daily vaccination capacity (80,000 versus 170,000) 

* Timing between first and second dose (3-6 weeks versus 3-12 weeks)

* Vaccine hesitancy (7% versus 13%). 

```{r}

t2 <- data.frame(
  scenario = seq(1,8),
  capacity = c(rep('80,000', 4), rep('170,000', 4)),
  gap = c(rep('3 to 6 weeks', 2), rep('3 to 12 weeks', 2), rep('3 to 6 weeks', 2), rep('3 to 12 weeks', 2)),
  hesitancy = c('7%', '13%', '7%', '13%', '7%', '13%', '7%', '13%')
)


kbl(t2,
      format = 'latex',
      booktabs = TRUE,
      linesep = '',
      label = 'scenarios', 
      align = c('lrrr'),
      col.names = c("Scenario", "Capacity (units per day)", "Gap between doses", "Hesitancy"),
      caption = "Projection scenarios" ) %>%
      kable_styling(latex_options = c("hover", "striped", "HOLD_position"),
                    full_width = TRUE,
                    position = "center") %>% 
      column_spec(1, bold = T)

```

The projections assumed that those who were hesitant would never receive the vaccine. The range of hesitancy rates were based on the survey data reported by Edwards et al [@edwards2020covid], and only applied to general population groups. Border staff, healthcare and aged care workers, aged care residents and adults with a medical condition were assumed to have 0% vaccine hesitancy. 

## Vaccine allocation
We allocated the daily available vaccination doses according to the following algorithm: 

1. Calculate the number of second doses due, based on the specified permissible range for the second dose. As an example, if the second dose is is specified to be administered between 3 and 6 weeks, then the booster shots for people vaccinated on day 1 would be evenly distributed across the three weeks between day 22 and day 42).

2. Assign the remaining doses from the daily limit to those awaiting their first dose.

3. Identify the highest priority phase that haven't received all first doses.

4. Divide the available first doses between the subgroups in the highest priority phase, proportional to the number of unvaccinated individuals remaining in each subgroup. 

5. Stop when all population members, minus those who are hesitant, have been vaccinated twice. 

## Software and code

The analysis was performed using RStudio version 4.0.3. The source code can be accessed at https://github.com/CBDRH/vaccinatingAustralia. 





# Results

Results from the eight scenarios are presented in Table \ref{tab:scenarios}. Scenarios that assumed a vaccine hesitancy of 7% among the general population resulted in 48,337,780 vaccine doses administered to 24,168,890 people, corresponding to a population coverage of 94.0%. Scenarios that assumed the vaccine higher hesitancy rate of 13% resulted in 45,713,020 vaccine doses administered to 22,856,510 people for a coverage of 88.9%.

Under the most optimistic Scenario (Scenario 6), assuming a start date of 15 February, Phase 1a would be fully vaccinated (i.e. primer and booster doses administered) as early as 30 March---just six weeks. The entire adult population would be fully vaccinated by 11 October---in line with government targets---and a further four weeks would see the entire population include those under 18 vaccinated. Even under this optimistic scenario, however, those in Phase 2a, including adults aged 60-69 years, would remain largely unvaccinated throughout the winter. Under this scenario, we would reach 50% population coverage in mid July and 75% population Around the start of October (Figure \ref{fig:cumlResults}A).

```{r}

t3 <- rbind(
        sumScenario(sc1),
        sumScenario(sc2),
        sumScenario(sc3),
        sumScenario(sc4),
        sumScenario(sc5),
        sumScenario(sc6),
        sumScenario(sc7),
        sumScenario(sc8)
        ) %>%
    mutate(scenario = row_number()) %>%
    relocate("scenario")

kbl(t3,
    format = 'latex',
    booktabs = TRUE,
    linesep = '',
    label = 'projections', 
    align = c('lrrr'),
    col.names = c("Scenario", "Number of vaccinations", "Individuals vaccinated", "Population coverage",
                  "Phase 1a complete", "Phase 1b complete", "Phase 2a complete", "Phase 2b complete", "Phase 3 complete"),
    caption = "Summary of vaccine rollout projections for different scenarios" ) %>%
  kable_styling(latex_options = c("hover", "striped", "HOLD_position"),
                full_width = TRUE,
                position = "center") %>%
  column_spec(1, bold = T) 

```

Under the less optimistic scenarios of 80,000 doses administered daily, it would take until June or July 2022 to vaccinate the adult population (Table \ref{tab:scenarios}). Under Scenario 1, we would reach 50% population coverage around January 2022 and 75% population coverage in July 2022 (Figure \ref{fig:cumlResults}A).

```{r cumlResults, fig.cap='Cumulative vaccine doses over time', fig.height=6.5, fig.width=6.5, fig.align='center'}

fig1a <- plotScenario(sc7, 'A. Scenario 6 (170,000 units per day)')
fig1b <- plotScenario(sc1, 'B. Scenario 1 (80,000 units per day)')

ggpubr::ggarrange(fig1a, fig1b,
                  ncol = 1, 
                  common.legend = TRUE, 
                  legend = 'bottom')

```

# Discussion

To meet the target of vaccinating all adult Australians by the end of October 2021 there will need to be in the order of 170,000 doses delivered daily on average--a furious pace. 

To put bounds on the feasibility of this target, a potentially illuminating exercise is to compare to the vaccination rates achieved by other countries who have already begun to roll out their vaccination programs (Figure \ref{fig:dailyVac}. The stand out leader is Israel, where between 7,000 and 20,000 vaccinations per million population have been delivered daily through out January. Several factors have contributed to this success, including a young, centralised population and a strong public health infrastructure. Perhaps most important has been strong logistical planning, including coordination of delivery, cold-chain storage and staffing.[@mckee2021can] Other countries have been less successful in their rollout, including the United States (4,000 per million pop), the United Kingdom (5,000 per million pop) and the European Union (1,100 per million pop).  

 With a population of 25.7 million in Australia, the figure of 170,000 doses per day from our projections corresponds to around 6,600 daily doses per million population. It will be possible to vaccinate the Australian population in just nine months but we will need to  do considerably better than the rates currently being achieved in most countries. We need to start now, get up to speed quickly and maintain that pace. The invitation extended to community pharmacies to participate in the vaccination rollout is a welcome development. There are some 5,800 community pharmacies across Australia; if each could vaccinate 15 community members a day that would represent half of the daily target of 170,000 to cross the finish line for community vaccination by the end of October.

```{r dailyVac, fig.align='center', fig.cap='Daily COVID-19 vaccines administered per one million population', fig.subcap='(source: ourworldindata.org'}

# Data on daily vaccinations sourced from Our World in Data
dailyVac <- readr::read_csv('https://raw.githubusercontent.com/owid/covid-19-data/master/public/data/vaccinations/vaccinations.csv')

dv1 <- dailyVac %>% filter(location %in% c('United States',
                                    'United Kingdom',
                                    'European Union',
                                    'Serbia',
                                    'Canada',
                                    'Israel')) %>% 
                    filter(date >= as.Date("2021/01/01")) 

ggplot(dv1, 
       aes(x = date, 
           y = daily_vaccinations_per_million, 
           group = location,
           color = location)) +
    geom_line(size = 1.2) +
    scale_y_continuous(name = 'Daily vaccinations per milliom', 
                       labels = scales::comma_format()) +
    scale_x_date(name = 'Date', date_labels = '%d %b',
                 breaks = 'week',
                 limits = c(as.Date('2021/01/01'), Sys.Date())) +
    scale_color_discrete(name = 'Country') +
    theme_dark() +
    labs(caption = "Data source: ourworldindata.org")
    
```


# References







