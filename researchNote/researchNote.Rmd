---
title: 'Vaccinating Australia: How long will it take?'
authors:
  - name: Mark Hanly
    department: Centre for Big Data Research in Health
    affiliation: UNSW Sydney
    location: Sydney 2052
    email: m.hanly@unsw.edu.au
  - name: Tim Churches
    department: Ingham Institute for Applied Medical Research
    affiliation: South Western Sydney Clinical School, Faculty of Medicine, UNSW Sydney
    location: Liverpool
    email: timothy.churches@unsw.edu.au
  - name: Oisín Fitzgerald
    department: Centre for Big Data Research in Health
    affiliation: UNSW Sydney
    location: Sydney 2052
    email: o.fitzgerald@unsw.edu.au
  - name: Louisa Jorm
    department: Centre for Big Data Research in Health
    affiliation: UNSW Sydney
    location: Sydney 2052
    email: l.jorm@unsw.edu.au
abstract: |
  Enter the text of your abstract here.
keywords:
  - COVID19
  - vaccination
bibliography: references.bib
biblio-style: unsrt
csl: jama.csl
output: 
  rticles::arxiv_article:
    keep_tex: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, error = FALSE, message = FALSE)

# libraries
library(dplyr)
library(kableExtra)

# Source functions
source('../R/sumScenario.R')
source('../R/plotScenario.R')

# Load scenario data
load('../Outputs/sc1.rda')
load('../Outputs/sc2.rda')
load('../Outputs/sc3.rda')
load('../Outputs/sc4.rda')
load('../Outputs/sc5.rda')
load('../Outputs/sc6.rda')
load('../Outputs/sc7.rda')
load('../Outputs/sc8.rda')

```


# Introduction

The COVID-19 pandemic continues to wreck devastating health impacts, having reached 100 million cases and 2.1 million deaths worldwide, as of 1 February 2021. The worsening crisis has led to the hospitals and ICU departments being overwhelmed in many countries. Australia has escaped the worst of these health impacts, through a combination of border closures, local and state-wide lock down measures and effective tracking and quarantining of exposed individuals. While effective in mitigating the spread of the virus, these measures have come at a massive cost for many industries, including tourism, aviation, retail, tertiary education and the arts. While the program of hotel quarantine has been largely effective in blocking transmission from international arrivals it is clearly not a panacea. Sporadic seeding events have spawned community clusters leading to further disruptive lockdowns in Victoria, Adelaide, Sydney and Brisbane.

Several COVID-19 vaccines with promising clinical trial results have been developed or are close to completion, with national rollouts already begun in many countries including Israel, the United States and the United Kingdom. The Australian government has entered into four agreements for the supply of COVID-19 vaccines (Table \ref{tab:agreements}), with a view to starting vaccination in February. The national rollout strategy divides the population into 16 groups, organised into five phases (Table \ref{tab:phases}).   
```{r}

t0 <- data.frame(
  name = c('Pfizer/BioNTech', 'University of Oxford AstraZeneca', 'Novavax', 'COVAX Facility'),
  type = c('mRNA vaccine', 'Viral vector vaccine', 'Protein vaccine', 'Assorted'),
  doses = c('10', '54', '51', '25'), 
  schedule = c('2 doses 21 days apart', '2 doses 28 days apart', '2 doses 21 days apart', 'Assorted'),
  status = c('Provisionally approved by the TGA',
             'Phase 3 clinical trials',
             'Phase 3 clinical trials', '9 candidate vaccines in various clinical trial stages')
)
  
kbl(t0,
      format = 'latex',
      booktabs = TRUE,
      linesep = '',
      label = 'agreements', 
      align = c('llcll'),
      col.names = c("Name", "Type", "Doses (millions)", 'Schedule', 'Status'),
      caption = "Australia’s vaccine agreements") %>%
      kable_styling(latex_options = c("hover", "striped", "HOLD_position"),
                    position = "center") %>% 
      column_spec(1, width = '3cm') %>%
      column_spec(2, width = '3cm') %>%
      column_spec(3, width = '1cm') %>%
      column_spec(4, width = '2cm') %>%
      column_spec(5, width = '5cm') %>%
      add_footnote('Adapted from https://www.health.gov.au/initiatives-and-programs/covid-19-vaccines/about-covid-19-vaccines/australias-vaccine-agreements', notation = 'none', threeparttable = TRUE)

```

Hospital hubs with access cold chain storage facilities will administer the Pfizer/BioNTech vaccine to the highest priority groups scheduled in Phase 1a, which includes border workers, frontline healthcare staff, and aged care staff and residents. The prime minister has set an optimistic target of 80,000 vaccines per day.[@pm2021] 

* A back of the envelope calculation would suggest it would take 500 days to vaccinate 20 million adult Australians twice. 
* But there are some complications e.g. timing of second doses and vaccine hesitancy; we are going to need a bigger envelope. 
* Aim of this analysis is to calculate how long it will take the vaccinate the whole Australian population


```{r}
t1 <- data.frame(
        phase = c('1a', '1a', '1a', '1a', '1b', '1b', '1b', '1b', '1b', '1b', '2a', '2a', '2a', '2a', '2b', '3'),
        desc = c('Quarantine & border workers',
                    'Frontline health care workers',
                    'Aged care and disability care staff',
                    'Aged care and disability care residents',
                    'Elderly adults aged 80 years and over',
                    'Elderly adults aged 70-79 years',
                    'Other health care workers',
                    'Aboriginal and Torres Strait Islander people aged 55 years and over',
                    'Younger adults with an underlying medical condition',
                    'Critical and high risk workers',
                    'Adults aged 60-69',
                    'Adults aged 50-59',
                    'Aboriginal and Torres Strait Islander people aged 18-54',
                    'Other critical and high risk workers',
                    'Balance of adult population',
                    '<18 if recommended'),
                size = format(c(70000, 100000, 318000, 190000, 1045000, 1858000, 953000, 87000, 2000000, 196000, 2650000, 3080000, 387000, 453000, 6643000, 5670000), big.mark = ','))

kbl(t1,
      format = 'latex',
      booktabs = TRUE,
      linesep = '',
      label = 'phases', 
      align = c('llr'),
      col.names = c("Phase", "Description", "Size"),
      caption = "Australia’s COVID-19 vaccine national roll-out strategy") %>%
      kable_styling(latex_options = c("hover", "striped", "HOLD_position"),
                    full_width = FALSE,
                    position = "center") %>% 
      column_spec(1, bold = T, width = '1cm') %>%
      column_spec(2, width = '11cm') %>% 
      column_spec(3, width = '2cm') %>% 
      add_footnote('Adapted from https://www.health.gov.au/sites/default/files/documents/2021/01/australia-s-covid-19-vaccine-national-roll-out-strategy.pdf', notation = 'none', threeparttable = TRUE)
```

# Methods

## Population and priority groups
Our analysis was based on the 16 priority groups and five phases proposed by the Australian government (see Table \ref{tab:phases}). This resulted in an estimated population size of 25.7 million people, including 5.67 million under the age of 18. Equal priority was given to all groups within the same phase.

## Vaccine roll out projections
Roll out projections were based on four parameters: 

1. The daily vaccination capacity. We denote the available units on day $i$ as $units_i$. 
2. The minimum number of days between the first dose and the second dose, denoted $minDose$. 
3. The maximum number of days between the first dose and the second dose, denoted $maxDose$. 
4. Vaccine hesitancy

## Vaccine allocation
We allocated the daily available vaccination doses according to the following algorithm: 

1. Calculate the number of second doses due. 

2. Calculate the number of first doses available as $firstDoses_i = units_i - secondDoses_i$

3. Identify the highest priority phase that haven't received all first doses

4. Divide the available first doses between the subgroups in the highest priority phase, proportional to the 


## Projection scenarios



* Vary three factors with two levels each resulting in 8 scenarios (see Table 2)
* Daily vaccination capacity (60,000 versus 80,000) 
* Timing between first and second dose (3 to 6 weeks, versus 3 to 12 weeks)
* Vaccine hesitancy (7% versus 13%) based on recent survey data from Edwards et al (the projections assume taht hesitancy applies to general population groups but not to health or border workers, age care residents or those with an underlying condition)
* Assume that the vaccine is administered according to the priority phases set out by the government
* All groups within a given phase are given equal priority
* Daily capacity is first divided between those needing second dose to ensure all second doses are delivered within the specified window; the remainder of the daily capacity distributed among those requiring their first dose. 

The analysis was performed using RStudio version 4.0.3. The source code can be accessed at https://github.com/CBDRH/vaccinatingAustralia. 



```{r}

t2 <- data.frame(
  scenario = seq(1,8),
  capacity = c(rep('80,000', 4), rep('60,000', 4)),
  gap = c(rep('3 to 6 weeks', 2), rep('3 to 12 weeks', 2), rep('3 to 6 weeks', 2), rep('3 to 12 weeks', 2)),
  hesitancy = c('7%', '13%', '7%', '13%', '7%', '13%', '7%', '13%')
)


kbl(t2,
      format = 'latex',
      booktabs = TRUE,
      linesep = '',
      label = 'scenarios', 
      align = c('lrrr'),
      col.names = c("Scenario", "Capacity (units per day)", "Gap between doses", "Hesitancy"),
      caption = "Projection scenarios" ) %>%
      kable_styling(latex_options = c("hover", "striped", "HOLD_position"),
                    full_width = TRUE,
                    position = "center") %>% 
      column_spec(1, bold = T)

```

# Results

* Under the most optimistic Scenario (Scenario 1), assuming vaccination starts on March 1, the highest priority group would be fully vaccinated with two doses by April 16th, just over six weeks (see Table 4).
* However it would still take nearly nine months to complete Phase 2a, which includes adults aged 60-69 years. 
* It would take until July 2022 to fully vaccinate the adult population and a further four months after that to vaccinate those under 18.
* Under this scenario, we would reach 50% population coverage in February 2022 and 75% population coverage in July 2022 (See Figure 1A)

* Under less optimistic scenarios it would take until the end of 2022 to vaccinate the adult population. (see Table 4)
* Under this scenario, we would reach 50% population coverage in May 2022 and 75% population coverage in December 2022 (See Figure 1B) 

```{r}

t3 <- rbind(
        sumScenario(sc1),
        sumScenario(sc2),
        sumScenario(sc3),
        sumScenario(sc4),
        sumScenario(sc5),
        sumScenario(sc6),
        sumScenario(sc7),
        sumScenario(sc8)
        ) %>%
    mutate(scenario = row_number()) %>%
    relocate("scenario")

kbl(t3,
    format = 'latex',
    booktabs = TRUE,
    linesep = '',
    label = 'projections', 
    align = c('lrrr'),
    col.names = c("Scenario", "Number of vaccinations", "Individuals vaccinated", "Population coverage",
                  "Phase 1a complete", "Phase 1b complete", "Phase 2a complete", "Phase 2b complete", "Phase 3 complete"),
    caption = "Summary of vaccine rollout projections for different scenarios" ) %>%
  kable_styling(latex_options = c("hover", "striped", "HOLD_position"),
                full_width = TRUE,
                position = "center") %>%
  column_spec(1, bold = T)

```



```{r, fig.cap='Cumulative vaccine doses of time'}

fig1a <- plotScenario(sc1, 'A. Scenario 1 (80,000 units per day)')
fig1b <- plotScenario(sc7, 'B. Scenario 7 (60,000 units per day)')

ggpubr::ggarrange(fig1a, fig1b,
                  ncol = 1, 
                  common.legend = TRUE, 
                  legend = 'bottom')

```



# Discussion

* Don't book your summer holidays just yet.

# References







